
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>XRISK Demo</title>

<style>
body {font-family:Arial;margin:0;background:#001429}
header{background:#000;color:#fff;padding:15px 30px;display:flex;justify-content:space-between}
header a{color:#fff;margin:0 15px;text-decoration:none;font-weight:bold}
.hero{background:#fff;padding:50px;text-align:center}
.section{background:#fff;margin:20px auto;padding:40px;border-radius:8px;max-width:1100px;position:relative}
.pbi-wrapper{width:100%;height:560px;overflow:hidden;border-radius:8px}
.pbi-wrapper iframe{width:100%;height:700px;border:0}
.btn-exportar{position:absolute;top:20px;right:20px;background:#28a745;color:#fff;border:0;padding:10px 18px;border-radius:6px;cursor:pointer}
</style>
</head>

<body>

<header>
<div style="font-size:22px;font-weight:bold">XRISK Demo</div>
<nav>
<a href="#dashboard1">Dashboard 1</a>
<a href="#dashboard2">Dashboard 2 PDF</a>
<a href="#dashboard3">Looker Studio</a>
</nav>
</header>

<section class="hero">
<h1>Lleva tu empresa al siguiente nivel</h1>
</section>

<!-- DASHBOARD 1 -->
<section id="dashboard1" class="section">
<h2>Dashboard Power BI Normal</h2>
<iframe src="https://app.powerbi.com/view?r=eyJrIjoiNDBmZDUzN2QtNWU4Yy00Y2QzLTg0NDctMjMxNjRkYzZiMDdjIiwidCI6IjFlYmE0NDNmLTIzZTUtNDUzNC05MGQxLTA5NzZhYWJlODZhYyIsImMiOjR9"
style="width:100%;height:560px;border:0"></iframe>
</section>

<!-- DASHBOARD 2 -->
<section id="dashboard2" class="section">
<h2>Dashboard Power BI PDF</h2>
<button class="btn-exportar" id="btnPBI">ðŸ“„ Descargar PDF</button>
<div id="areaPBI" class="pbi-wrapper">
<iframe src="https://app.powerbi.com/view?r=eyJrIjoiNDBmZDUzN2QtNWU4Yy00Y2QzLTg0NDctMjMxNjRkYzZiMDdjIiwidCI6IjFlYmE0NDNmLTIzZTUtNDUzNC05MGQxLTA5NzZhYWJlODZhYyIsImMiOjR9"></iframe>
</div>
</section>

<!-- DASHBOARD 3 LOOKER -->
<section id="dashboard3" class="section">
<h2>Dashboard Looker Studio</h2>
<button class="btn-exportar" id="btnLooker">ðŸ“„ Descargar PDF</button>

<div id="areaLooker" style="width:100%;height:700px">
<iframe 
    src="https://lookerstudio.google.com/embed/reporting/ba06d8a4-d596-4363-b8b8-f62b2f62a65e/page/p_dhrvayvyzd"
    style="width:100%;height:100%;border:0">
</iframe>
</div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
const {jsPDF}=window.jspdf;


<!-- DASHBOARD 4 SOLO WEB (PDF DIRECTO DESDE PYTHON) -->
<section id="soloWeb" class="section">
<h2>Dashboard Looker â€“ Descarga directa Web</h2>
<button class="btn-exportar" id="btnSoloWeb">ðŸ“„ Descargar PDF</button>

<div style="width:100%;height:700px">
<iframe 
    src="https://lookerstudio.google.com/embed/reporting/ba06d8a4-d596-4363-b8b8-f62b2f62a65e/page/p_dhrvayvyzd"
    style="width:100%;height:100%;border:0">
</iframe>
</div>
</section>

// Looker PDF directo desde servidor Python
document.getElementById("btnSoloWeb").onclick = ()=>{
  fetch("http://127.0.0.1:5000/exportar-looker")
   .then(r => r.blob())
   .then(blob => {
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "Looker_XRISK.pdf";
      document.body.appendChild(a);
      a.click();
      a.remove();
   })
   .catch(()=>alert("Error conectando con el servidor Python"));
}

// Power BI PDF
document.getElementById("btnPBI").onclick=()=>{
 html2canvas(document.getElementById("areaPBI"),{scale:2,useCORS:true}).then(c=>{
  const pdf=new jsPDF("l","px",[c.width,c.height]);
  pdf.addImage(c.toDataURL(),"PNG",0,0,c.width,c.height);
  pdf.save("PowerBI_XRISK.pdf");
 });
}

// Looker PDF via Apps Script
document.getElementById("btnLooker").onclick=()=>{
 fetch("https://script.google.com/macros/s/AKfycbwWN6PHM9WLdwuY3JroK7Ro-PKdM44hXJIO1C_w_37JmGnaSbB6kbf2yfvfQSsj_wsHag/exec")
   .then(()=>alert("Tu PDF fue generado y guardado en tu Google Drive"))
   .catch(()=>alert("Error al generar el PDF"));
}
</script>

</body>
</html>



